{"filter":false,"title":"views.py","tooltip":"/art_store/views.py","undoManager":{"mark":6,"position":6,"stack":[[{"start":{"row":345,"column":0},"end":{"row":395,"column":0},"action":"remove","lines":["","","","\"\"\" ","@login_required(login_url = '/')","def ADD_ARTIST(request):","    if request.method == \"POST\":","        try:","            artist_obj = Artist(","                name=request.POST['name'],","                mobnum=request.POST['mobnum'],","                email=request.POST['email'],","                edudetails=request.POST['edudetails'],","                awarddetails=request.POST['awarddetails'],","                images = request.FILES.get('images')","            )","            artist_obj.save()","            ","            if s3_image_upload(request.FILES.get('images')):","                print(\"-------------------------> FILE UPLOADED SUCCESSFULLY\")","            else:","                print(\"-------------------------> FILE UPLOAD FAILED...\")","","            ","            # Send an email notification via API Gateway","            email_subject = \"New Artist Added!\"","            email_message = f\"New artist '{artist_obj.name}' has been successfully added.\\n\\n\" \\","                            f\"Mobile: {artist_obj.mobnum}\\n\" \\","                            f\"Email: {artist_obj.email}\\n\" \\","                            f\"Education Details: {artist_obj.edudetails}\\n\" \\","                            f\"Award Details: {artist_obj.awarddetails}\"","","            email_response = send_email_api(email_subject, email_message, \"projectmail2223@gmail.com\")","","            if email_response:","                print(f\"Email API Response: {email_response}\")","            else:","                print(\"Error: Email could not be sent\")","","            ","            ","            messages.success(request, \"Artist details has been created successfully\")","            return redirect('add_artist')","        except IntegrityError:","            messages.error(request, \"Email and Mobilenumber must be unique\")","        except Exception as e:","            messages.error(request, f\"An error occurred: {str(e)}\")","    ","    return render(request,'add-artist.html')"," \"\"\"",""],"id":2}],[{"start":{"row":313,"column":0},"end":{"row":345,"column":0},"action":"remove","lines":["","","# import requests","","# def send_email_api(subject, message, email):","#     \"\"\"","#     Send an email using the API Gateway URL that triggers the Lambda function.","#     \"\"\"","#     API_URL = \"https://p4wbnyopmg.execute-api.eu-west-2.amazonaws.com/stage1/art-exhibition-lambda\"","","#     # Prepare the payload","#     payload = {","#         \"subject\": subject,","#         \"message\": message,","#         \"email\": email","#     }","","#     try:","#         # Send POST request to the API","#         response = requests.post(API_URL, json=payload, headers={\"Content-Type\": \"application/json\"})","","#         # Check for a successful response","#         if response.status_code == 200:","#             data = response.json()","#             print(f\"Email API Response: {data}\")","#             return data.get(\"message\", \"No response message\")","#         else:","#             print(f\"Error: API returned status {response.status_code}\")","#             return None","#     except Exception as e:","#         print(f\"Error while sending email via API: {str(e)}\")","#         return None",""],"id":3}],[{"start":{"row":155,"column":0},"end":{"row":160,"column":63},"action":"remove","lines":["            # # SNS call","            # if send_email_sns(\"Enquiry\",request.POST['message'], art_product.title, request.POST['email'],request.POST['mobnum']):","","            #     print(\"-------------------------> MAIL SENT\")","            # else:","            #     print(\"-------------------------> MAIL FAIL\")"],"id":4}],[{"start":{"row":20,"column":0},"end":{"row":66,"column":91},"action":"remove","lines":["# def s3_image_upload(file_obj, object_name=None):","#     bucket_name = \"art-exhibotion-s3\"","    ","#     if object_name is None:","#         object_name = file_obj.name  ","","#     s3_client = boto3.client('s3')","#     try:","#         s3_client.upload_fileobj(file_obj, bucket_name, object_name)  ","#         print(f\"File '{file_obj.name}' uploaded successfully to '{bucket_name}/{object_name}'\")","#         return True","#     except Exception as e:","#         print(f\"Error: {e}\")","#         return False","","","","","# def send_email_sns(subject, message, art_product, email, phone):","#     SNS_TOPIC_ARN = \"arn:aws:sns:eu-west-2:250738637992:art-exhibition-cpp-sns\"","    ","#     full_message = f\"\"\"Enquiry details:\\n","#         Art product: {art_product}\\n","#         Email: {email}\\n","#         Phone: {phone}\\n","#         Message: {message}\\n","#     \"\"\"","","#     try:","#         # Use the correct region (eu-west-2)","#         sns_client = boto3.client(\"sns\", region_name=\"eu-west-2\")  ","        ","#         response = sns_client.publish(","#             TopicArn=SNS_TOPIC_ARN,","#             Message=full_message,","#             Subject=subject","#         )","        ","#         print(f\"Email sent successfully! Message ID: {response['MessageId']}\")","#         return True","","#     except Exception as e:","#         print(f\"Error sending email: {e}\")","#         return False","","","###########################################################################################"],"id":5}],[{"start":{"row":20,"column":0},"end":{"row":21,"column":0},"action":"remove","lines":["",""],"id":7},{"start":{"row":19,"column":0},"end":{"row":20,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":854,"column":0},"end":{"row":896,"column":0},"action":"remove","lines":["","# from django.core.mail import send_mail","# from django.contrib import messages","# from django.shortcuts import redirect","","","# def VIEW_ENQUIRY_RESPOND(request, id):","#     try:","#         enquiry = Enquiry.objects.get(id=id)","","#         if request.method == \"POST\":","#             response_text = request.POST.get(\"response_text\")","","#             # Update enquiry","#             enquiry.response_text = response_text","#             enquiry.status = \"Responded\"","#             enquiry.save()","","#             # Send Email to Customer via SMTP","#             subject = \"Response to Your Art Exhibition Enquiry\"","#             message = (","#                 f\"Dear {enquiry.name},\\n\\n\"","#                 f\"Thank you for contacting us.\\n\\n\"","#                 f\"Your Enquiry: {enquiry.message}\\n\\n\"","#                 f\"Our Response: {response_text}\\n\\n\"","#                 f\"Regards,\\nArt Exhibition Management Team\"","#             )","","#             send_mail(","#                 subject,","#                 message,","#                 None,","#                 [enquiry.email],","#                 fail_silently=False,","#             )","","#             messages.success(request, \"Response sent to customer successfully.\")","#             return redirect(\"view_enquiries\")","","#     except Enquiry.DoesNotExist:","#         messages.error(request, \"Enquiry not found.\")","#         return redirect(\"view_enquiries\")",""],"id":8}],[{"start":{"row":277,"column":12},"end":{"row":277,"column":14},"action":"insert","lines":["# "],"id":9},{"start":{"row":278,"column":12},"end":{"row":278,"column":14},"action":"insert","lines":["# "]},{"start":{"row":279,"column":12},"end":{"row":279,"column":14},"action":"insert","lines":["# "]},{"start":{"row":280,"column":12},"end":{"row":280,"column":14},"action":"insert","lines":["# "]},{"start":{"row":281,"column":12},"end":{"row":281,"column":14},"action":"insert","lines":["# "]},{"start":{"row":283,"column":12},"end":{"row":283,"column":14},"action":"insert","lines":["# "]},{"start":{"row":284,"column":12},"end":{"row":284,"column":14},"action":"insert","lines":["# "]},{"start":{"row":285,"column":12},"end":{"row":285,"column":14},"action":"insert","lines":["# "]},{"start":{"row":286,"column":12},"end":{"row":286,"column":14},"action":"insert","lines":["# "]},{"start":{"row":287,"column":12},"end":{"row":287,"column":14},"action":"insert","lines":["# "]},{"start":{"row":288,"column":12},"end":{"row":288,"column":14},"action":"insert","lines":["# "]},{"start":{"row":290,"column":12},"end":{"row":290,"column":14},"action":"insert","lines":["# "]},{"start":{"row":292,"column":12},"end":{"row":292,"column":14},"action":"insert","lines":["# "]},{"start":{"row":293,"column":12},"end":{"row":293,"column":14},"action":"insert","lines":["# "]},{"start":{"row":294,"column":12},"end":{"row":294,"column":14},"action":"insert","lines":["# "]},{"start":{"row":295,"column":12},"end":{"row":295,"column":14},"action":"insert","lines":["# "]}]]},"ace":{"folds":[],"scrolltop":3488.5,"scrollleft":0,"selection":{"start":{"row":296,"column":0},"end":{"row":296,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":267,"state":"start","mode":"ace/mode/python"}},"timestamp":1765020918928,"hash":"88550b45a4afbb4e3d0f2e4ea273db94dc883023"}